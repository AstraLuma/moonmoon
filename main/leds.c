#include <inttypes.h>

#include "driver/ledc.h"
#include "esp_err.h"


const uint32_t phase_max = 0xFFFF;
// Lookup table mapping lunar day -> duty cycles
const uint32_t phases[28][5] = {
    {0x0000, 0x0000, 0x0000, 0x0000, 0x0000},
    {0x1249, 0x0000, 0x0000, 0x0000, 0x0000},
    {0x2492, 0x0000, 0x0000, 0x0000, 0x0000},
    {0xFFFF, 0x03A8, 0x0000, 0x0000, 0x0000},
    {0xFFFF, 0x15F1, 0x0000, 0x0000, 0x0000},
    {0xFFFF, 0x283A, 0x0000, 0x0000, 0x0000},
    {0xFFFF, 0xFFFF, 0x0750, 0x0000, 0x0000},
    {0xFFFF, 0xFFFF, 0x1999, 0x0000, 0x0000},
    {0xFFFF, 0xFFFF, 0x2BE2, 0x0000, 0x0000},
    {0xFFFF, 0xFFFF, 0xFFFF, 0x0AF8, 0x0000},
    {0xFFFF, 0xFFFF, 0xFFFF, 0x1D41, 0x0000},
    {0xFFFF, 0xFFFF, 0xFFFF, 0x2F8A, 0x0000},
    {0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x0EA0},
    {0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x20E9},
    {0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF},
    {0x20E9, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF},
    {0x0EA0, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF},
    {0x0000, 0x2F8A, 0xFFFF, 0xFFFF, 0xFFFF},
    {0x0000, 0x1D41, 0xFFFF, 0xFFFF, 0xFFFF},
    {0x0000, 0x0AF8, 0xFFFF, 0xFFFF, 0xFFFF},
    {0x0000, 0x0000, 0x2BE2, 0xFFFF, 0xFFFF},
    {0x0000, 0x0000, 0x1999, 0xFFFF, 0xFFFF},
    {0x0000, 0x0000, 0x0750, 0xFFFF, 0xFFFF},
    {0x0000, 0x0000, 0x0000, 0x283A, 0xFFFF},
    {0x0000, 0x0000, 0x0000, 0x15F1, 0xFFFF},
    {0x0000, 0x0000, 0x0000, 0x03A8, 0xFFFF},
    {0x0000, 0x0000, 0x0000, 0x0000, 0x2492},
    {0x0000, 0x0000, 0x0000, 0x0000, 0x1249},
};

/// Sets up the LED hardware
void led_init() {
    // TODO
}

/// Updates the state of the LEDs to match the given lunar day
void set_moon_phase(int phase) {
    // TODO
}
